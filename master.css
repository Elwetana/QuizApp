:root {
  --square-gap: 12px;
  --bg: #0f172a;      /* slate-900 */
  --card: #111827;    /* gray-900 */
  --muted: #94a3b8;   /* slate-400 */
  --text: #f8fafc;    /* slate-50 */
  --accent: #22c55e;  /* green-500 */
  --accent-2: #38bdf8;/* sky-400 */
}
* { box-sizing: border-box; }
html, body { margin: 0; background: var(--bg); color: var(--text); height: 100%; }
body { 
    font-family: "Jannon Sans Book", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial;
    display: flex; 
    justify-content: center; 
    align-items: center; 
    overflow: hidden;
}

/* Fixed 16:9 stage centered both horizontally and vertically */
#stage { 
    width: min(100vw, calc(100vh * (16 / 9))); 
    height: min(100vh, calc(100vw * (9 / 16)));
    max-width: 100vw;
    max-height: 100vh;
}

/* Layout fills the 16:9 stage and acts as a container for cqh */
#layout { display: flex; height: 100%; width: 100%; overflow: hidden; container-type: size; }
/* Presentation (single-question) mode */
#present { height: 100%; width: 100%; padding: 16px; display: flex; align-items: stretch; justify-content: stretch; }
#present .panel { background: var(--card); border: 1px solid #1f2937; border-radius: .8rem; width: 100%; height: 100%; display: grid; grid-template-rows: 1fr; }
#present .qwrap { padding: 1.5rem; height: 100%; min-height: 0; }
#present .panel > .qwrap { grid-row: 1 / -1; }
#present .qwrap .body { min-height: 0; }
#present .qwrap .title { font-size: clamp(28px, min(10cqh, 10cqw), 96px); font-weight: 800; margin-bottom: .5rem; }
#present .qwrap .body { overflow: hidden; display: grid; align-content: start; justify-items: center; container-type: size; }
/* Slightly smaller responsive text to ensure fit */
#present .qwrap .text { width: 100%; text-align: left; font-size: clamp(20px, min(12cqh, 10cqw), 96px); line-height: 1.15; overflow-wrap: anywhere; word-break: break-word; hyphens: auto; }
/* In presentation mode, keep hints same size as question text */
#present .qwrap .hint { color: var(--muted); margin-top: .5rem; font-size: clamp(20px, min(12cqh, 10cqw), 96px); line-height: 1.15; overflow-wrap: anywhere; word-break: break-word; hyphens: auto; }

/* No promotion overrides in presentation mode: all texts same size */

/* 3x2 square grid sized to exact 13.5:9 proportion */
#grid {
  display: flex;
  flex-wrap: wrap;
  align-content: flex-start;
  gap: var(--square-gap);
  padding: var(--square-gap);
  width: 135cqh; /* 13.5 * container height / 9 = 1.5 * container height */
  min-width: 0;
}

#grid .cell {
  width: calc((100% - 2 * var(--square-gap)) / 3);
  aspect-ratio: 1 / 1;
  background: var(--card);
  border: 1px solid #1f2937;
  border-radius: .8rem;
  overflow: hidden;
  display: flex;
  align-items: stretch;
  justify-content: stretch;
}

#grid .cell .inner { padding: 1rem; width: 100%; height: 100%; overflow: hidden; }

#grid .cell.info { display: grid; place-content: center; text-align: center; }
#grid .cell.info .round { font-size: 2.2rem; font-weight: 700; margin-bottom: .5rem; color: var(--text); }
#grid .cell.info .clock { font-size: 3rem; font-variant-numeric: tabular-nums; color: var(--accent-2); }

/* Right strip (unused for now) */
#strip { flex: 1 1 auto; border-left: 1px solid #1f2937; background: #0b1220; overflow: auto; }
#strip .board { padding: 1rem; }
#strip .board-title { font-weight: 800; letter-spacing: .02em; margin: 0 0 .5rem 0; }
#strip .board-list { list-style: none; padding: 0; margin: 0; display: grid; gap: .25rem; }
#strip .board-list li { display: flex; align-items: baseline; justify-content: space-between; gap: .5rem; background: rgba(0,0,0,0.15); border: 1px solid rgba(0,0,0,0.25); border-radius: .4rem; padding: .35rem .5rem; }
#strip .board-list li .rank { width: 2ch; opacity: .85; }
#strip .board-list li .team { font-weight: 600; }
#strip .board-list li .pts { font-variant-numeric: tabular-nums; }
#strip .board-list li.empty { background: transparent; border: none; opacity: .8; justify-content: flex-start; }

/* Content styles for questions */
.qwrap { display: grid; grid-template-rows: auto 1fr; gap: .5rem; padding: 1rem; width: 100%; }
.qwrap .title { font-size: 1.6rem; font-weight: 700; }
.qwrap .body { overflow: hidden; container-type: size; }
.qwrap .body img { width: 100%; height: 100%; object-fit: contain; border-radius: .4rem; border: 1px solid #1f2937; }
#present .qwrap .body img { width: auto; height: auto; min-height: 99cqh; }
#present .qwrap .body { min-height: 99cqh; }
#present .qwrap.overlay-letter { position: relative; container-type: size; }
#present .qwrap.overlay-letter .title.image-overlay { position: absolute; top: .5rem; left: .75rem; z-index: 1; background: rgba(0,0,0,0.4); padding: .2rem .5rem; border-radius: .4rem; font-size: clamp(18px, min(9cqh, 8cqw), 80px); color: var(--text); }
.qwrap .body .text { font-size: clamp(18px, min(10cqh, 8cqw), 80px); line-height: 1.2; font-weight: 100;}
.qwrap .hint { font-size: 0.75em; }
.qwrap .hint { color: var(--muted); margin-top: .25rem; }

/* Grid view: promote hint within cell and downscale question text */
#grid .qwrap.has-promote .hint.promote { color: var(--text); font-size: clamp(18px, min(9cqh, 8cqw), 80px); line-height: 1.2; }
#grid .qwrap.has-promote .body .text { color: var(--muted); font-size: clamp(14px, min(7cqh, 6cqw), 56px); }
/* In grid, keep hint1 same size as question text when hint2 is promoted */
#grid .qwrap.has-promote .hint:not(.promote) { color: var(--muted); font-size: clamp(14px, min(7cqh, 6cqw), 56px); }

/* No media rule needed; width is based on stage height via cqh */

/* Dynamic font sizing for long text */
.text-long { font-size: clamp(16px, min(9cqh, 7cqw), 72px) !important; }
.text-very-long { font-size: clamp(14px, min(8cqh, 6cqw), 56px) !important; }
.text-extremely-long { font-size: clamp(12px, min(6cqh, 5cqw), 48px) !important; }

/* Utility classes */
.hidden { display: none !important; }

/* Overlay for team entry */
.overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: grid; place-items: center; z-index: 9999; }
.modal { background: var(--card); border: 1px solid #1f2937; border-radius: .8rem; padding: 1.25rem; width: min(520px, 92vw); }
.modal h2 { margin: 0 0 .75rem 0; font-size: 1.25rem; }
.modal input[type=password] { width: 100%; }
.modal .row { display: flex; gap: .5rem; margin-top: .75rem; }
.modal .result { color: var(--muted); min-height: 1.2rem; margin-top: .25rem; }

/* Finished round (results) view */
.fin-panel { background: var(--card); border: 1px solid #1f2937; border-radius: .8rem; width: 100%; height: 100%; display: grid; grid-template-rows: auto 1fr; padding: 2rem; }
.fin-header { font-size: clamp(28px, min(10cqh, 10cqw), 96px); font-weight: 800; margin-bottom: 1rem; color: var(--text); }
.fin-answers { overflow-y: auto; display: grid; gap: .75rem; align-content: start; justify-items: end; }
.fin-answer { padding: 1rem; border-radius: 0.8rem; display: flex; justify-content: flex-end; align-items: center; min-height: 3rem; width: fit-content(100%); max-width: 100%; }
.fin-answer.correct { background: #22c55e; color: #052e13; }
.fin-answer.incorrect { background: #9a0800; color: #f9fafb; }
.fin-answer-text { font-size: clamp(16px, min(6cqh, 5cqw), 48px); font-weight: 600; text-align: right; }

/* Finished round image slides with overlay */
.fin-img-panel { background: var(--card); border: 1px solid #1f2937; border-radius: .8rem; width: 100%; height: 100%; position: relative; overflow: hidden; }
.fin-image-wrap { position: absolute; inset: 0; }
.fin-image-wrap img { width: 100%; height: 100%; object-fit: contain; display: block; }
.fin-image-wrap .fin-letter { position: absolute; top: .75rem; left: .75rem; background: rgba(0,0,0,0.4); padding: .25rem .5rem; border-radius: .4rem; font-weight: 800; font-size: clamp(18px, min(9cqh, 8cqw), 80px); color: var(--text); }
.fin-overlay { position: absolute; inset: 0; display: flex; align-items: flex-end; justify-content: flex-end; pointer-events: none; padding: 1rem; }
.fin-overlay-box { pointer-events: auto; background: transparent; border: none; border-radius: .8rem; padding: 0; width: min(90%, 900px); max-height: 60%; overflow: auto; }
.fin-hint { font-size: clamp(14px, min(6cqh, 5cqw), 40px); font-weight: 700; color: var(--text); margin-bottom: .5rem; text-align: center; }

/* Finished round results table */
.fin-results { display: flex; flex-direction: row; align-items: flex-start; justify-content: center; gap: 2rem; }
.fin-results table { width: auto; max-width: 100%; border-collapse: collapse; table-layout: auto; font-size: clamp(16px, min(6cqh, 5cqw), 48px); font-weight: 100;}
.fin-results th, .fin-results td { border-bottom: 1px solid #1f2937; padding: .5rem; text-align: left; }
.fin-results th { font-weight: 400; }
.fin-results td.score { text-align: right; font-variant-numeric: tabular-nums; }
